{"version":3,"sources":["../../../src/app/controllers/ScheduleController.js"],"names":["ScheduleController","index","req","res","checkUserProvider","User","findOne","where","id","userId","provider","status","json","error","date","query","parsedDate","appointments","Appointment","findAll","provider_id","canceled_at","Op","between","order"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA,MAAMA,kBAAN,CAAyB;AACvB,QAAMC,KAAN,CAAYC,GAAZ,EAAiBC,GAAjB,EAAsB;AACpB,UAAMC,iBAAiB,GAAG,MAAMC,cAAKC,OAAL,CAAa;AAC3CC,MAAAA,KAAK,EAAE;AACLC,QAAAA,EAAE,EAAEN,GAAG,CAACO,MADH;AAELC,QAAAA,QAAQ,EAAE;AAFL;AADoC,KAAb,CAAhC;;AAOA,QAAI,CAACN,iBAAL,EAAwB;AACtB,aAAOD,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAArB,CAAP;AACD;;AAED,UAAM;AAAEC,MAAAA;AAAF,QAAWZ,GAAG,CAACa,KAArB;AACA,UAAMC,UAAU,GAAG,uBAASF,IAAT,CAAnB;AAEA,UAAMG,YAAY,GAAG,MAAMC,qBAAYC,OAAZ,CAAoB;AAC7CZ,MAAAA,KAAK,EAAE;AACLa,QAAAA,WAAW,EAAElB,GAAG,CAACO,MADZ;AAELY,QAAAA,WAAW,EAAE,IAFR;AAGLP,QAAAA,IAAI,EAAE;AACJ,WAACQ,cAAGC,OAAJ,GAAc,CAAC,yBAAWP,UAAX,CAAD,EAAyB,uBAASA,UAAT,CAAzB;AADV;AAHD,OADsC;AAQ7CQ,MAAAA,KAAK,EAAE,CAAC,MAAD;AARsC,KAApB,CAA3B;AAUA,WAAOrB,GAAG,CAACS,IAAJ,CAASK,YAAT,CAAP;AACD;;AA3BsB;;eA8BV,IAAIjB,kBAAJ,E","sourcesContent":["import { startOfDay, endOfDay, parseISO } from 'date-fns';\nimport { Op } from 'sequelize';\nimport Appointment from '../models/Appointment';\nimport User from '../models/User';\n\nclass ScheduleController {\n  async index(req, res) {\n    const checkUserProvider = await User.findOne({\n      where: {\n        id: req.userId,\n        provider: true,\n      },\n    });\n\n    if (!checkUserProvider) {\n      return res.status(401).json({ error: 'User is not a provider' });\n    }\n\n    const { date } = req.query;\n    const parsedDate = parseISO(date);\n\n    const appointments = await Appointment.findAll({\n      where: {\n        provider_id: req.userId,\n        canceled_at: null,\n        date: {\n          [Op.between]: [startOfDay(parsedDate), endOfDay(parsedDate)],\n        },\n      },\n      order: ['date'],\n    });\n    return res.json(appointments);\n  }\n}\n\nexport default new ScheduleController();\n"],"file":"ScheduleController.js"}